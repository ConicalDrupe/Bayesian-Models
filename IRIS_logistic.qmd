
# Import Data
```{python}
import os
import pandas as pd
# import statsmodels.api as sm

df = pd.read_csv(os.path.join(os.getcwd(),'data','iris.csv'))
print(df.head())

X = df[['Sepal.Length','Sepal.Width','Petal.Length','Petal.Width']]
Y = df['Species']

print(Y.nunique())
```

# Frequentist Logistic Regression
```{python}
log_reg = sm.Logit(Y,X).fit()
print(log_reg.summary())
```

## Frequestist Logistic Regressions
- What do you observe?
- Do you see any problems?

# Bayesian Logistic Regression

```{python}
import arviz as az
import pymc as pm 

X['intercept'] = 1

with pm.Model() as model:
    # Beta priors
    beta = pm.Normal('beta', mu=0, sigma=100, shape=X.shape[1])

    # Logit Model
    p = pm.invlogit(pm.math.dot(X, beta))

    # Likelihood of the data
    y_obs = pm.Binomial('y_obs',n=X.shape[0],p=p, observed=Y)

    # Inference
    trace = pm.sample(2000, tune=1000)
    ppc = pm.sample_posterior_predictive(trace)

# Analyzing results
print(X.columns)
print(pm.summary(trace))

```

## Trace
```{python}
plt.figure()
az.plot_trace(trace, figsize=(10, 7));
plt.show()
```
